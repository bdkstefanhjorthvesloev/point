{
	"name": "dataflow2",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "dbo_cmdb_ci_business_application",
						"type": "DatasetReference"
					},
					"name": "businessapplicationsource"
				},
				{
					"dataset": {
						"referenceName": "Usertable",
						"type": "DatasetReference"
					},
					"name": "usersource"
				},
				{
					"dataset": {
						"referenceName": "company_table",
						"type": "DatasetReference"
					},
					"name": "companysource"
				},
				{
					"dataset": {
						"referenceName": "department_table",
						"type": "DatasetReference"
					},
					"name": "departmentsource"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "business_application_table",
						"type": "DatasetReference"
					},
					"name": "transformbusinessapp1"
				}
			],
			"transformations": [
				{
					"name": "Join1"
				},
				{
					"name": "Join2"
				},
				{
					"name": "Select1"
				},
				{
					"name": "Select2"
				},
				{
					"name": "Join3"
				},
				{
					"name": "Select3"
				},
				{
					"name": "Join4"
				},
				{
					"name": "Select4"
				}
			],
			"script": "source(output(\n\t\t{Business Application ID} as string,\n\t\t{Business Application Number} as string,\n\t\t{Business Application Name} as string,\n\t\t{Business Application Description} as string,\n\t\t{Business Application Criticality} as string,\n\t\t{Business Application Life Cycle Stage} as string,\n\t\t{Business Application Class Name} as string,\n\t\t{Business Application Data Classification} as string,\n\t\t{Business Application Life Cycle Stage Status} as string,\n\t\t{Business Application Contract Manager Name} as string,\n\t\t{Business Application Contract End Date} as timestamp,\n\t\t{Business Application Certified} as boolean,\n\t\t{Business Application Emergency Tier} as string,\n\t\t{Business Application Cat2 Classified} as boolean,\n\t\t{Business Application Operational Status} as integer,\n\t\t{Business Application Install Type} as string,\n\t\t{Business Application Domain} as string,\n\t\t{Business Application Install Status} as integer,\n\t\t{Business Application Business Process} as string,\n\t\t{Business Application Created Date} as timestamp,\n\t\t{Business Application Created_by Name} as string,\n\t\t{Business Application Updated Date} as timestamp,\n\t\t{Business Application Updated by Name} as string,\n\t\t{Business Application Business Owner ID} as string,\n\t\t{Business Application Vendor ID} as string,\n\t\t{Business Application Support Vendor ID} as string,\n\t\t{Business Application Company ID} as string,\n\t\t{Business Application Department ID} as string,\n\t\t{Business Application IT Application Owner ID} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> businessapplicationsource\nsource(output(\n\t\t{User ID} as string,\n\t\t{User Name} as string,\n\t\t{User Full Name} as string,\n\t\t{User First Name} as string,\n\t\t{User Last Name} as string,\n\t\t{User Email} as string,\n\t\t{User Title} as string,\n\t\t{User Department} as string,\n\t\t{User Employee Number} as string,\n\t\t{User Mobile Phone Number} as string,\n\t\t{User Phone} as string,\n\t\t{User Company} as string,\n\t\t{User Active Flag} as boolean,\n\t\t{User Location} as string,\n\t\t{User City} as string,\n\t\t{User Street Name} as string,\n\t\t{User Zip Code} as string,\n\t\t{User Manager ID} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> usersource\nsource(output(\n\t\t{Company ID} as string,\n\t\t{Company Name} as string,\n\t\t{Company Street} as string,\n\t\t{Company Phone} as string,\n\t\t{Company City} as string,\n\t\t{Company Class Name } as string,\n\t\t{Company sys_created_on_value} as timestamp,\n\t\t{Company sys_created_by_value} as string,\n\t\t{Company sys_updated_by_value} as string,\n\t\t{Company sys_updated_on_value} as timestamp\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> companysource\nsource(output(\n\t\t{Department ID} as string,\n\t\t{Department Name} as string,\n\t\t{Company ID} as string,\n\t\t{Department Description} as string,\n\t\t{Department Created Date} as timestamp,\n\t\t{Department Created by Name} as string,\n\t\t{Department Updated Date} as timestamp,\n\t\t{Department Updated by Name} as string,\n\t\tID as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> departmentsource\nbusinessapplicationsource, usersource join({Business Application Business Owner ID} == {User ID},\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join1\nSelect1, companysource join({Business Application Company ID} == {Company ID},\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join2\nJoin1 select(mapColumn(\n\t\t{Business Application ID},\n\t\t{Business Application Number},\n\t\t{Business Application Name},\n\t\t{Business Application Description},\n\t\t{Business Application Criticality},\n\t\t{Business Application Life Cycle Stage},\n\t\t{Business Application Class Name},\n\t\t{Business Application Data Classification},\n\t\t{Business Application Life Cycle Stage Status},\n\t\t{Business Application Contract Manager Name},\n\t\t{Business Application Contract End Date},\n\t\t{Business Application Certified},\n\t\t{Business Application Emergency Tier},\n\t\t{Business Application Cat2 Classified},\n\t\t{Business Application Operational Status},\n\t\t{Business Application Install Type},\n\t\t{Business Application Domain},\n\t\t{Business Application Install Status},\n\t\t{Business Application Business Process},\n\t\t{Business Application Created Date},\n\t\t{Business Application Created_by Name},\n\t\t{Business Application Updated Date},\n\t\t{Business Application Updated by Name},\n\t\t{Business Application Business Owner ID},\n\t\t{Business Application Vendor ID},\n\t\t{Business Application Support Vendor ID},\n\t\t{Business Application Company ID},\n\t\t{Business Application Department ID},\n\t\t{Business Application IT Application Owner ID},\n\t\t{Business Application Owner User Name} = {User Name},\n\t\t{Business Application Owner User Full Name} = {User Full Name},\n\t\t{Business Application Owner Email} = {User Email},\n\t\t{Business Application Owner Mobile Phone Number} = {User Mobile Phone Number},\n\t\t{Business Application Owner Company} = {User Company}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nJoin2 select(mapColumn(\n\t\t{Business Application ID},\n\t\t{Business Application Number},\n\t\t{Business Application Name},\n\t\t{Business Application Description},\n\t\t{Business Application Criticality},\n\t\t{Business Application Life Cycle Stage},\n\t\t{Business Application Class Name},\n\t\t{Business Application Data Classification},\n\t\t{Business Application Life Cycle Stage Status},\n\t\t{Business Application Contract Manager Name},\n\t\t{Business Application Contract End Date},\n\t\t{Business Application Certified},\n\t\t{Business Application Emergency Tier},\n\t\t{Business Application Cat2 Classified},\n\t\t{Business Application Operational Status},\n\t\t{Business Application Install Type},\n\t\t{Business Application Domain},\n\t\t{Business Application Install Status},\n\t\t{Business Application Business Process},\n\t\t{Business Application Created Date},\n\t\t{Business Application Created_by Name},\n\t\t{Business Application Updated Date},\n\t\t{Business Application Updated by Name},\n\t\t{Business Application Business Owner ID},\n\t\t{Business Application Vendor ID},\n\t\t{Business Application Support Vendor ID},\n\t\t{Business Application Company ID},\n\t\t{Business Application Department ID},\n\t\t{Business Application IT Application Owner ID},\n\t\t{Business Owner User Name} = {Business Application Owner User Name},\n\t\t{Business Owner User Full Name} = {Business Application Owner User Full Name},\n\t\t{Business Owner Email} = {Business Application Owner Email},\n\t\t{Business Owner Mobile Phone Number} = {Business Application Owner Mobile Phone Number},\n\t\t{Business Owner Company} = {Business Application Owner Company},\n\t\t{Business Application Company Name} = {Company Name}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select2\nSelect2, departmentsource join({Business Application Department ID} == {Department ID},\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join3\nJoin3 select(mapColumn(\n\t\t{Business Application ID},\n\t\t{Business Application Number},\n\t\t{Business Application Name},\n\t\t{Business Application Description},\n\t\t{Business Application Criticality},\n\t\t{Business Application Life Cycle Stage},\n\t\t{Business Application Class Name},\n\t\t{Business Application Data Classification},\n\t\t{Business Application Life Cycle Stage Status},\n\t\t{Business Application Contract Manager Name},\n\t\t{Business Application Contract End Date},\n\t\t{Business Application Certified},\n\t\t{Business Application Emergency Tier},\n\t\t{Business Application Cat2 Classified},\n\t\t{Business Application Operational Status},\n\t\t{Business Application Install Type},\n\t\t{Business Application Domain},\n\t\t{Business Application Install Status},\n\t\t{Business Application Business Process},\n\t\t{Business Application Created Date},\n\t\t{Business Application Created_by Name},\n\t\t{Business Application Updated Date},\n\t\t{Business Application Updated by Name},\n\t\t{Business Application Business Owner ID},\n\t\t{Business Application Vendor ID},\n\t\t{Business Application Support Vendor ID},\n\t\t{Business Application Company ID},\n\t\t{Business Application Department ID},\n\t\t{Business Application IT Application Owner ID},\n\t\t{Business Owner User Name},\n\t\t{Business Owner User Full Name},\n\t\t{Business Owner Email},\n\t\t{Business Owner Mobile Phone Number},\n\t\t{Business Owner Company},\n\t\t{Business Application Company Name},\n\t\t{Business Application Department Name} = {Department Name}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select3\nSelect3, usersource join({Business Application IT Application Owner ID} == {User ID},\n\tjoinType:'left',\n\tbroadcast: 'auto')~> Join4\nJoin4 select(mapColumn(\n\t\t{Business Application ID},\n\t\t{Business Application Number},\n\t\t{Business Application Name},\n\t\t{Business Application Description},\n\t\t{Business Application Criticality},\n\t\t{Business Application Life Cycle Stage},\n\t\t{Business Application Class Name},\n\t\t{Business Application Data Classification},\n\t\t{Business Application Life Cycle Stage Status},\n\t\t{Business Application Contract Manager Name},\n\t\t{Business Application Contract End Date},\n\t\t{Business Application Certified},\n\t\t{Business Application Emergency Tier},\n\t\t{Business Application Cat2 Classified},\n\t\t{Business Application Operational Status},\n\t\t{Business Application Install Type},\n\t\t{Business Application Domain},\n\t\t{Business Application Install Status},\n\t\t{Business Application Business Process},\n\t\t{Business Application Created Date},\n\t\t{Business Application Created_by Name},\n\t\t{Business Application Updated Date},\n\t\t{Business Application Updated by Name},\n\t\t{Business Application Business Owner ID},\n\t\t{Business Application Vendor ID},\n\t\t{Business Application Support Vendor ID},\n\t\t{Business Application Company ID},\n\t\t{Business Application Department ID},\n\t\t{Business Application IT Application Owner ID},\n\t\t{Business Owner User Name},\n\t\t{Business Owner User Full Name},\n\t\t{Business Owner Email},\n\t\t{Business Owner Mobile Phone Number},\n\t\t{Business Owner Company},\n\t\t{Business Application Company Name},\n\t\t{Business Application Department Name},\n\t\t{IT Application Owner User Name} = {User Name},\n\t\t{IT Application Owner Name} = {User Full Name},\n\t\t{IT Application Owner Email} = {User Email},\n\t\t{IT Application Owner Department} = {User Department},\n\t\t{IT Application Owner Mobile Phone Number} = {User Mobile Phone Number}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select4\nSelect4 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> transformbusinessapp1"
		}
	}
}